@@ -3,14 +3,39 @@
 if( isset( $_COOKIE[ 'id' ] ) ) {
 	// Get input
 	$id = $_COOKIE[ 'id' ];
+	$exists = false;
 
-	// Check database
-	$getid  = "SELECT first_name, last_name FROM users WHERE user_id = '$id' LIMIT 1;";
-	$result = mysqli_query($GLOBALS["___mysqli_ston"],  $getid ); // Removed 'or die' to suppress mysql errors
+	switch ($_DVWA['SQLI_DB']) {
+		case MYSQL:
+			// Check database
+			$query  = "SELECT first_name, last_name FROM users WHERE user_id = '$id' LIMIT 1;";
+			$result = mysqli_query($GLOBALS["___mysqli_ston"],  $query ); // Removed 'or die' to suppress mysql errors
 
-	// Get results
-	$num = @mysqli_num_rows( $result ); // The '@' character suppresses errors
-	if( $num > 0 ) {
+			// Get results
+			try {
+				$exists = (mysqli_num_rows( $result ) > 0); // The '@' character suppresses errors
+			} catch(Exception $e) {
+				$exists = false;
+			}
+
+			((is_null($___mysqli_res = mysqli_close($GLOBALS["___mysqli_ston"]))) ? false : $___mysqli_res);
+			break;
+		case SQLITE:
+			global $sqlite_db_connection;
+
+			$query  = "SELECT first_name, last_name FROM users WHERE user_id = '$id' LIMIT 1;";
+			try {
+				$results = $sqlite_db_connection->query($query);
+				$row = $results->fetchArray();
+				$exists = $row !== false;
+			} catch(Exception $e) {
+				$exists = false;
+			}
+
+			break;
+	}
+
+	if ($exists) {
 		// Feedback for end user
 		$html .= '<pre>User ID exists in the database.</pre>';
 	}
@@ -26,8 +51,6 @@ if( isset( $_COOKIE[ 'id' ] ) ) {
 		// Feedback for end user
 		$html .= '<pre>User ID is MISSING from the database.</pre>';
 	}
-
-	((is_null($___mysqli_res = mysqli_close($GLOBALS["___mysqli_ston"]))) ? false : $___mysqli_res);
 }
 
 ?>
