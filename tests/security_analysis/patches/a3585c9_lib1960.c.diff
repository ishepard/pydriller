@@ -23,18 +23,7 @@
  ***************************************************************************/
 #include "test.h"
 
-#ifdef HAVE_INET_PTON
-
-#ifdef HAVE_NETINET_IN_H
-#include <netinet/in.h>
-#endif
-#ifdef HAVE_SYS_SOCKET_H
-#include <sys/socket.h>
-#endif
-#ifdef HAVE_ARPA_INET_H
-#include <arpa/inet.h>
-#endif
-
+#include "inet_pton.h"
 #include "memdebug.h"
 
 /* to prevent libcurl from closing our socket */
@@ -101,7 +90,7 @@ CURLcode test(char *URL)
   serv_addr.sin_family = AF_INET;
   serv_addr.sin_port = htons(port);
 
-  if(inet_pton(AF_INET, libtest_arg2, &serv_addr.sin_addr) <= 0) {
+  if(Curl_inet_pton(AF_INET, libtest_arg2, &serv_addr.sin_addr) <= 0) {
     fprintf(stderr, "inet_pton failed\n");
     goto test_cleanup;
   }
@@ -139,11 +128,3 @@ test_cleanup:
 
   return res;
 }
-#else
-CURLcode test(char *URL)
-{
-  (void)URL;
-  printf("lacks inet_pton\n");
-  return CURLE_OK;
-}
-#endif
