@@ -3212,7 +3212,7 @@ CURLcode _my_setopt(CURL *curl, const char *name, CURLoption tag, ...)
 {
   va_list arg;
   CURLcode ret;
-  char buffer[128];
+  char *bufp;
   char value[256];
   bool remark=FALSE;
 
@@ -3249,13 +3249,12 @@ CURLcode _my_setopt(CURL *curl, const char *name, CURLoption tag, ...)
     ret = curl_easy_setopt(curl, tag, oval);
   }
 
-  sprintf(buffer, "%scurl_easy_setopt(hnd, %s, %s);%s",
-          remark?"/* ":"",
-          name, value,
-          remark?" [REMARK] */":"");
-
-  easycode = curl_slist_append(easycode, buffer);
+  bufp = curl_maprintf("%scurl_easy_setopt(hnd, %s, %s);%s",
+                       remark?"/* ":"", name, value,
+                       remark?" [REMARK] */":"");
 
+  easycode = curl_slist_append(easycode, bufp);
+  curl_free(bufp);
   va_end(arg);
 
   return ret;
