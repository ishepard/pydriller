@@ -94,6 +94,7 @@ jobs:
         - *common_packages
         - libpsl-dev
         - libbrotli-dev
+        - libzstd-dev
   - env:
     - T=novalgrind BORINGSSL=yes C="--with-ssl=$HOME/boringssl" LD_LIBRARY_PATH=/home/travis/boringssl/lib:/usr/local/lib
     - OVERRIDE_CC="CC=gcc-8" OVERRIDE_CXX="CXX=g++-8"
@@ -111,6 +112,7 @@ jobs:
         - *common_packages
         - libpsl-dev
         - libbrotli-dev
+        - libzstd-dev
   - env:
     - T=novalgrind NGTCP2=yes C="--with-ssl=$HOME/ngbuild --with-ngtcp2=$HOME/ngbuild --with-nghttp3=$HOME/ngbuild --enable-alt-svc" NOTESTS=
     - OVERRIDE_CC="CC=gcc-8" OVERRIDE_CXX="CXX=g++-8"
@@ -121,6 +123,7 @@ jobs:
         - *common_packages
         - libpsl-dev
         - libbrotli-dev
+        - libzstd-dev
   - env:
     - T=novalgrind NGTCP2=yes GNUTLS=yes C="PKG_CONFIG_PATH=$HOME/ngbuild --without-ssl --with-gnutls=$HOME/ngbuild --with-ngtcp2=$HOME/ngbuild --with-nghttp3=$HOME/ngbuild --enable-alt-svc" NOTESTS=
     - OVERRIDE_CC="CC=gcc-8" OVERRIDE_CXX="CXX=g++-8"
@@ -131,6 +134,7 @@ jobs:
         - *common_packages
         - libpsl-dev
         - libbrotli-dev
+        - libzstd-dev
         - autogen
         - automake
         - autopoint
@@ -151,6 +155,7 @@ jobs:
         - *common_packages
         - libpsl-dev
         - libbrotli-dev
+        - libzstd-dev
   - env:
     - T=debug-mesalink C="--with-mesalink --without-ssl"
     - OVERRIDE_CC="CC=gcc-8" OVERRIDE_CXX="CXX=g++-8"
@@ -161,6 +166,7 @@ jobs:
         - *common_packages
         - libpsl-dev
         - libbrotli-dev
+        - libzstd-dev
   - env:
     - T=debug
     - &clang OVERRIDE_CC="CC=clang-9" OVERRIDE_CXX="CXX=clang++-9"
@@ -172,6 +178,7 @@ jobs:
         - &clang_packages [*common_packages, clang-9]
         - libpsl-dev
         - libbrotli-dev
+        - libzstd-dev
   - env:
     - T=debug C="--enable-alt-svc"
     - *clang
@@ -183,6 +190,7 @@ jobs:
         - *clang_packages
         - libpsl-dev
         - libbrotli-dev
+        - libzstd-dev
   - env:
     - T=debug C="--with-mbedtls --without-ssl"
     - *clang
@@ -194,6 +202,7 @@ jobs:
         - *clang_packages
         - libpsl-dev
         - libbrotli-dev
+        - libzstd-dev
         - libmbedtls-dev
   - env:
     - T=debug C="--with-gnutls --without-ssl"
@@ -207,6 +216,7 @@ jobs:
         - libgnutls28-dev
         - libpsl-dev
         - libbrotli-dev
+        - libzstd-dev
   - env:
     - T=debug C="--with-nss --without-ssl" NOTESTS=1 CPPFLAGS="-isystem /usr/include/nss"
     - *clang
@@ -219,11 +229,12 @@ jobs:
         - libnss3-dev
         - libpsl-dev
         - libbrotli-dev
+        - libzstd-dev
   - env:
     - T=iconv
     - OVERRIDE_CC="CC=gcc-8" OVERRIDE_CXX="CXX=g++-8"
   - env:
-    - T=cmake BORINGSSL=yes QUICHE=yes C="-DUSE_QUICHE=1 -DOPENSSL_ROOT_DIR=$HOME/boringssl"
+    - T=cmake BORINGSSL=yes QUICHE=yes C="-DUSE_QUICHE=1 -DOPENSSL_ROOT_DIR=$HOME/boringssl -DCURL_BROTLI=1 -DCURL_ZSTD=1"
     - OVERRIDE_CC="CC=gcc-8" OVERRIDE_CXX="CXX=g++-8"
     - PKG_CONFIG_PATH="$HOME/quiche/target/release"
     before_install:
@@ -235,8 +246,9 @@ jobs:
         - *common_packages
         - libpsl-dev
         - libbrotli-dev
+        - libzstd-dev
   - env:
-    - T=cmake NGTCP2=yes C="-DUSE_NGTCP2=ON"
+    - T=cmake NGTCP2=yes C="-DUSE_NGTCP2=ON -DCURL_BROTLI=1 -DCURL_ZSTD=1"
     - *clang
     - PKG_CONFIG_PATH="$HOME/ngbuild/lib/pkgconfig"
     compiler: clang
@@ -247,6 +259,7 @@ jobs:
         - *clang_packages
         - libpsl-dev
         - libbrotli-dev
+        - libzstd-dev
   - env:
     - T=torture
     - OVERRIDE_CC="CC=gcc-8" OVERRIDE_CXX="CXX=g++-8"
@@ -258,6 +271,7 @@ jobs:
         - lcov
         - libpsl-dev
         - libbrotli-dev
+        - libzstd-dev
         - libssh2-1-dev
   - env:
     - T=distcheck
@@ -269,6 +283,7 @@ jobs:
         - *common_packages
         - libpsl-dev
         - libbrotli-dev
+        - libzstd-dev
   - env:
     - T=fuzzer
     - *clang
@@ -280,6 +295,7 @@ jobs:
         - *clang_packages
         - libpsl-dev
         - libbrotli-dev
+        - libzstd-dev
   - env:
     - T=tidy
     - *clang
@@ -292,6 +308,7 @@ jobs:
         - clang-tidy-9
         - libpsl-dev
         - libbrotli-dev
+        - libzstd-dev
   - env:
     - T=scan-build
     - *clang
@@ -303,6 +320,7 @@ jobs:
         - *clang_packages
         - libpsl-dev
         - libbrotli-dev
+        - libzstd-dev
   - env:
     - T=debug CFLAGS="-fsanitize=address,undefined,signed-integer-overflow -fno-sanitize-recover=undefined,integer -Wformat -Werror=format-security -Werror=array-bounds -g" LDFLAGS="-fsanitize=address,undefined -fno-sanitize-recover=undefined,integer" LIBS="-ldl -lubsan"
     - *clang
@@ -314,6 +332,7 @@ jobs:
         - *clang_packages
         - libpsl-dev
         - libbrotli-dev
+        - libzstd-dev
   - env:
     - T=debug C="--enable-alt-svc"
     - OVERRIDE_CC="CC=gcc-8" OVERRIDE_CXX="CXX=g++-8"
@@ -325,6 +344,7 @@ jobs:
         - *common_packages
         - libpsl-dev
         - libbrotli-dev
+        - libzstd-dev
         - libev-dev
         - libssl-dev
         - libtool
