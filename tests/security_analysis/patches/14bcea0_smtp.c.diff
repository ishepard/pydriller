@@ -748,7 +748,7 @@ static CURLcode smtp_perform_mail(struct Curl_easy *data)
   }
 
   /* Setup client reader for size and EOB conversion */
-  result = Client_reader_set_fread(data, data->state.infilesize);
+  result = Curl_creader_set_fread(data, data->state.infilesize);
   if(result)
     goto out;
   /* Add the client reader doing STMP EOB escaping */
@@ -1909,12 +1909,24 @@ static CURLcode cr_eob_read(struct Curl_easy *data,
   return CURLE_OK;
 }
 
+static curl_off_t cr_eob_total_length(struct Curl_easy *data,
+                                      struct Curl_creader *reader)
+{
+  /* this reader changes length depending on input */
+  (void)data;
+  (void)reader;
+  return -1;
+}
+
 static const struct Curl_crtype cr_eob = {
   "cr-smtp-eob",
   cr_eob_init,
   cr_eob_read,
   cr_eob_close,
   Curl_creader_def_needs_rewind,
+  cr_eob_total_length,
+  Curl_creader_def_resume_from,
+  Curl_creader_def_rewind,
   sizeof(struct cr_eob_ctx)
 };
 
