@@ -959,7 +959,7 @@ if(USE_LIBIDN2)
     check_include_file_concat("idn2.h" HAVE_IDN2_H)
   endif()
   if(NOT HAVE_LIBIDN2 OR NOT HAVE_IDN2_H)
-    if(UNIX)
+    if(NOT MSVC OR VCPKG_TOOLCHAIN)
       find_package(PkgConfig QUIET)
       pkg_search_module(LIBIDN2 "libidn2")
     endif()
@@ -1038,7 +1038,7 @@ if(NOT USE_LIBSSH2 AND CURL_USE_LIBSSH)
   find_package(libssh CONFIG QUIET)
   if(libssh_FOUND)
     message(STATUS "Found libssh ${libssh_VERSION}")
-  else()
+  elseif(NOT MSVC OR VCPKG_TOOLCHAIN)
     find_package(PkgConfig QUIET)
     pkg_search_module(LIBSSH "libssh")
     if(LIBSSH_FOUND)
@@ -1058,10 +1058,16 @@ endif()
 option(CURL_USE_GSASL "Use GSASL implementation" OFF)
 mark_as_advanced(CURL_USE_GSASL)
 if(CURL_USE_GSASL)
-  find_package(PkgConfig REQUIRED)
-  pkg_search_module(GSASL REQUIRED "libgsasl")
-  list(APPEND CURL_LIBS ${GSASL_LINK_LIBRARIES})
-  set(USE_GSASL ON)
+  if(NOT MSVC OR VCPKG_TOOLCHAIN)
+    find_package(PkgConfig REQUIRED)
+    pkg_search_module(GSASL REQUIRED "libgsasl")
+  else()
+    message(WARNING "GSASL has been requested but requires a platform with pkg-config support. Skipping.")
+  endif()
+  if(GSASL_FOUND)
+    list(APPEND CURL_LIBS ${GSASL_LINK_LIBRARIES})
+    set(USE_GSASL ON)
+  endif()
 endif()
 
 option(CURL_USE_GSSAPI "Use GSSAPI implementation (right now only Heimdal is supported with CMake build)" OFF)
@@ -1133,8 +1139,10 @@ if(CURL_USE_LIBUV)
   if(NOT ENABLE_DEBUG)
     message(FATAL_ERROR "Using libuv without debug support enabled is useless")
   endif()
-  find_package(PkgConfig QUIET)
-  pkg_check_modules(LIBUV "libuv")
+  if(NOT MSVC OR VCPKG_TOOLCHAIN)
+    find_package(PkgConfig QUIET)
+    pkg_check_modules(LIBUV "libuv")
+  endif()
   if(LIBUV_FOUND)
     list(APPEND CURL_LIBS ${LIBUV_LINK_LIBRARIES})
     list(APPEND LIBCURL_PC_REQUIRES_PRIVATE "libuv")
