@@ -853,10 +853,12 @@ CURLcode Curl_http(struct connectdata *conn)
   }
 
   if(data->cookies) {
+    Curl_share_lock(data, CURL_LOCK_DATA_COOKIE, CURL_LOCK_ACCESS_SINGLE);
     co = Curl_cookie_getlist(data->cookies,
                              conn->allocptr.cookiehost?
                              conn->allocptr.cookiehost:host, ppath,
                              (bool)(conn->protocol&PROT_HTTPS?TRUE:FALSE));
+    Curl_share_unlock(data, CURL_LOCK_DATA_COOKIE);
   }
 
   if (conn->bits.httpproxy &&
