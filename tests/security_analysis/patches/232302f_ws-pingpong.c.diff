@@ -25,7 +25,6 @@
  * Websockets pingpong
  * </DESC>
  */
-
 /* curl stuff */
 #include "curl_setup.h"
 #include <curl/curl.h>
@@ -34,9 +33,14 @@
 #include <stdlib.h>
 #include <string.h>
 
-/* somewhat Unix-specific */
+#ifdef _WIN32
+#ifndef WIN32_LEAN_AND_MEAN
+#define WIN32_LEAN_AND_MEAN
+#endif
+#include <windows.h>
+#else
 #include <sys/time.h>
-#include <unistd.h>
+#endif
 
 #ifdef USE_WEBSOCKETS
 
@@ -102,7 +106,11 @@ static CURLcode pingpong(CURL *curl, const char *payload)
     fprintf(stderr, "Receive pong\n");
     res = recv_pong(curl, payload);
     if(res == CURLE_AGAIN) {
+#ifdef _WIN32
+      Sleep(100);
+#else
       usleep(100*1000);
+#endif
       continue;
     }
     websocket_close(curl);
