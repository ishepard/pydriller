@@ -116,7 +116,7 @@ krb5_overhead(void *app_data, int level, int len)
 }
 
 static int
-krb5_encode(void *app_data, void *from, int length, int level, void **to,
+krb5_encode(void *app_data, const void *from, int length, int level, void **to,
             struct connectdata *conn)
 {
   gss_ctx_id_t *context = app_data;
@@ -128,7 +128,10 @@ krb5_encode(void *app_data, void *from, int length, int level, void **to,
   /* shut gcc up */
   conn = NULL;
 
-  dec.value = from;
+  /* NOTE that the cast is safe, neither of the krb5, gnu gss and heimdal 
+   * libraries modify the input buffer in gss_seal()
+   */
+  dec.value = (void*)from;
   dec.length = length;
   maj = gss_seal(&min, *context,
 		 level == prot_private,
