@@ -28,16 +28,36 @@
 # RUSTLS_FOUND         System has rustls
 # RUSTLS_INCLUDE_DIRS  The rustls include directories
 # RUSTLS_LIBRARIES     The rustls library names
+# RUSTLS_VERSION       Version of rustls
 
-find_path(RUSTLS_INCLUDE_DIR "rustls.h")
+if(CURL_USE_PKGCONFIG)
+  find_package(PkgConfig QUIET)
+  pkg_search_module(PC_RUSTLS "rustls")
+endif()
+
+find_path(RUSTLS_INCLUDE_DIR "rustls.h"
+  HINTS
+    ${PC_RUSTLS_INCLUDEDIR}
+    ${PC_RUSTLS_INCLUDE_DIRS}
+)
 
 find_library(RUSTLS_LIBRARY "rustls")
+  HINTS
+    ${PC_RUSTLS_LIBDIR}
+    ${PC_RUSTLS_LIBRARY_DIRS}
+)
+
+if(PC_RUSTLS_VERSION)
+  set(RUSTLS_VERSION ${PC_RUSTLS_VERSION})
+endif()
 
 include(FindPackageHandleStandardArgs)
 find_package_handle_standard_args(rustls
   REQUIRED_VARS
     RUSTLS_INCLUDE_DIR
     RUSTLS_LIBRARY
+  VERSION_VAR
+    RUSTLS_VERSION
 )
 
 if(RUSTLS_FOUND)
