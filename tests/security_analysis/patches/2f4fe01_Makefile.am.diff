@@ -37,9 +37,8 @@ LIBDIR = $(top_builddir)/lib
 
 EXTRA_DIST = test307.pl
 
-# *NOTICE* that some test cases use curlx_* functions that are not in the API
-# but must be provided by source
-TIMEVAL=$(top_srcdir)/lib/timeval.c
+# Source code file used only in some libcurl test programs
+TESTUTIL = testutil.c
 
 # these files are used in every single test program below
 SUPPORTFILES = first.c test.h
@@ -60,13 +59,13 @@ lib500_DEPENDENCIES = $(DEPENDENCIES)
 lib501_SOURCES = lib501.c $(SUPPORTFILES)
 lib501_DEPENDENCIES = $(DEPENDENCIES)
 
-lib502_SOURCES = lib502.c $(SUPPORTFILES) $(TIMEVAL)
+lib502_SOURCES = lib502.c $(SUPPORTFILES) $(TESTUTIL)
 lib502_DEPENDENCIES = $(DEPENDENCIES)
 
-lib503_SOURCES = lib503.c $(SUPPORTFILES) $(TIMEVAL)
+lib503_SOURCES = lib503.c $(SUPPORTFILES) $(TESTUTIL)
 lib503_DEPENDENCIES = $(DEPENDENCIES)
 
-lib504_SOURCES = lib504.c $(SUPPORTFILES) $(TIMEVAL)
+lib504_SOURCES = lib504.c $(SUPPORTFILES) $(TESTUTIL)
 lib504_DEPENDENCIES = $(DEPENDENCIES)
 
 lib505_SOURCES = lib505.c $(SUPPORTFILES)
@@ -75,13 +74,13 @@ lib505_DEPENDENCIES = $(DEPENDENCIES)
 lib506_SOURCES = lib506.c $(SUPPORTFILES)
 lib506_DEPENDENCIES = $(DEPENDENCIES)
 
-lib507_SOURCES = lib507.c $(SUPPORTFILES) $(TIMEVAL)
+lib507_SOURCES = lib507.c $(SUPPORTFILES) $(TESTUTIL)
 lib507_DEPENDENCIES = $(DEPENDENCIES)
 
 lib508_SOURCES = lib508.c $(SUPPORTFILES)
 lib508_DEPENDENCIES = $(DEPENDENCIES)
 
-lib509_SOURCES = lib509.c $(SUPPORTFILES) $(TIMEVAL)
+lib509_SOURCES = lib509.c $(SUPPORTFILES) $(TESTUTIL)
 lib509_DEPENDENCIES = $(DEPENDENCIES)
 
 lib510_SOURCES = lib510.c $(SUPPORTFILES)
@@ -126,33 +125,33 @@ lib523_DEPENDENCIES = $(DEPENDENCIES)
 lib524_SOURCES = lib524.c $(SUPPORTFILES)
 lib524_DEPENDENCIES = $(DEPENDENCIES)
 
-lib525_SOURCES = lib525.c $(SUPPORTFILES) $(TIMEVAL)
+lib525_SOURCES = lib525.c $(SUPPORTFILES) $(TESTUTIL)
 lib525_DEPENDENCIES = $(DEPENDENCIES)
 
-lib526_SOURCES = lib526.c $(SUPPORTFILES) $(TIMEVAL)
+lib526_SOURCES = lib526.c $(SUPPORTFILES) $(TESTUTIL)
 lib526_CFLAGS = -DLIB526
 lib526_DEPENDENCIES = $(DEPENDENCIES)
 
-lib527_SOURCES = lib526.c $(SUPPORTFILES) $(TIMEVAL)
+lib527_SOURCES = lib526.c $(SUPPORTFILES) $(TESTUTIL)
 lib527_CFLAGS = -DLIB527
 lib527_DEPENDENCIES = $(DEPENDENCIES)
 
-lib529_SOURCES = lib525.c $(SUPPORTFILES) $(TIMEVAL)
+lib529_SOURCES = lib525.c $(SUPPORTFILES) $(TESTUTIL)
 lib529_CFLAGS = -DLIB529
 lib529_DEPENDENCIES = $(DEPENDENCIES)
 
-lib530_SOURCES = lib530.c $(SUPPORTFILES) $(TIMEVAL)
+lib530_SOURCES = lib530.c $(SUPPORTFILES) $(TESTUTIL)
 lib530_CFLAGS = -DLIB530
 lib530_DEPENDENCIES = $(DEPENDENCIES)
 
-lib532_SOURCES = lib526.c $(SUPPORTFILES) $(TIMEVAL)
+lib532_SOURCES = lib526.c $(SUPPORTFILES) $(TESTUTIL)
 lib532_CFLAGS = -DLIB532
 lib532_DEPENDENCIES = $(DEPENDENCIES)
 
-lib533_SOURCES = lib533.c $(SUPPORTFILES) $(TIMEVAL)
+lib533_SOURCES = lib533.c $(SUPPORTFILES) $(TESTUTIL)
 lib533_DEPENDENCIES = $(DEPENDENCIES)
 
-lib536_SOURCES = lib536.c $(SUPPORTFILES) $(TIMEVAL)
+lib536_SOURCES = lib536.c $(SUPPORTFILES) $(TESTUTIL)
 lib536_DEPENDENCIES = $(DEPENDENCIES)
 
 lib537_SOURCES = lib537.c $(SUPPORTFILES)
