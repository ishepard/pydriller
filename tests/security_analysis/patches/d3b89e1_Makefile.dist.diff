@@ -21,6 +21,8 @@
 # $Id$
 ###########################################################################
 
+VC=vc6
+
 all:
 	./configure
 	make
@@ -87,106 +89,106 @@ mingw32-clean:
 
 vc-clean:
 	cd lib
-	nmake -f Makefile.vc6 clean
+	nmake -f Makefile.$(VC) clean
 	cd ..\src
-	nmake -f Makefile.vc6 clean
+	nmake -f Makefile.$(VC) clean
 
 vc-all:
 	cd lib
-	nmake -f Makefile.vc6 cfg=release
-	nmake -f Makefile.vc6 cfg=release-ssl
-	nmake -f Makefile.vc6 cfg=release-zlib
-	nmake -f Makefile.vc6 cfg=release-ssl-zlib
-	nmake -f Makefile.vc6 cfg=release-ssl-dll
-	nmake -f Makefile.vc6 cfg=release-zlib-dll
-	nmake -f Makefile.vc6 cfg=release-ssl-dll-zlib-dll
-	nmake -f Makefile.vc6 cfg=release-dll
-	nmake -f Makefile.vc6 cfg=release-dll-ssl-dll
-	nmake -f Makefile.vc6 cfg=release-dll-zlib-dll
-	nmake -f Makefile.vc6 cfg=release-dll-ssl-dll-zlib-dll
-	nmake -f Makefile.vc6 cfg=debug
-	nmake -f Makefile.vc6 cfg=debug-ssl
-	nmake -f Makefile.vc6 cfg=debug-zlib
-	nmake -f Makefile.vc6 cfg=debug-ssl-zlib
-	nmake -f Makefile.vc6 cfg=debug-ssl-dll
-	nmake -f Makefile.vc6 cfg=debug-zlib-dll
-	nmake -f Makefile.vc6 cfg=debug-ssl-dll-zlib-dll
-	nmake -f Makefile.vc6 cfg=debug-dll
-	nmake -f Makefile.vc6 cfg=debug-dll-ssl-dll
-	nmake -f Makefile.vc6 cfg=debug-dll-zlib-dll
-	nmake -f Makefile.vc6 cfg=debug-dll-ssl-dll-zlib-dll
+	nmake -f Makefile.$(VC) cfg=release
+	nmake -f Makefile.$(VC) cfg=release-ssl
+	nmake -f Makefile.$(VC) cfg=release-zlib
+	nmake -f Makefile.$(VC) cfg=release-ssl-zlib
+	nmake -f Makefile.$(VC) cfg=release-ssl-dll
+	nmake -f Makefile.$(VC) cfg=release-zlib-dll
+	nmake -f Makefile.$(VC) cfg=release-ssl-dll-zlib-dll
+	nmake -f Makefile.$(VC) cfg=release-dll
+	nmake -f Makefile.$(VC) cfg=release-dll-ssl-dll
+	nmake -f Makefile.$(VC) cfg=release-dll-zlib-dll
+	nmake -f Makefile.$(VC) cfg=release-dll-ssl-dll-zlib-dll
+	nmake -f Makefile.$(VC) cfg=debug
+	nmake -f Makefile.$(VC) cfg=debug-ssl
+	nmake -f Makefile.$(VC) cfg=debug-zlib
+	nmake -f Makefile.$(VC) cfg=debug-ssl-zlib
+	nmake -f Makefile.$(VC) cfg=debug-ssl-dll
+	nmake -f Makefile.$(VC) cfg=debug-zlib-dll
+	nmake -f Makefile.$(VC) cfg=debug-ssl-dll-zlib-dll
+	nmake -f Makefile.$(VC) cfg=debug-dll
+	nmake -f Makefile.$(VC) cfg=debug-dll-ssl-dll
+	nmake -f Makefile.$(VC) cfg=debug-dll-zlib-dll
+	nmake -f Makefile.$(VC) cfg=debug-dll-ssl-dll-zlib-dll
 
 vc:
 	cd lib
-	nmake /f Makefile.vc6 cfg=release
+	nmake /f Makefile.$(VC) cfg=release
 	cd ..\src
-	nmake /f Makefile.vc6
+	nmake /f Makefile.$(VC)
 
 vc-zlib:
 	cd lib
-	nmake /f Makefile.vc6 cfg=release-zlib
+	nmake /f Makefile.$(VC) cfg=release-zlib
 	cd ..\src
-	nmake /f Makefile.vc6 cfg=release-zlib
+	nmake /f Makefile.$(VC) cfg=release-zlib
 
 vc-ssl:
 	cd lib
-	nmake /f Makefile.vc6 cfg=release-ssl
+	nmake /f Makefile.$(VC) cfg=release-ssl
 	cd ..\src
-	nmake /f Makefile.vc6 cfg=release-ssl
+	nmake /f Makefile.$(VC) cfg=release-ssl
 
 vc-ssl-zlib:
 	cd lib
-	nmake /f Makefile.vc6 cfg=release-ssl-zlib
+	nmake /f Makefile.$(VC) cfg=release-ssl-zlib
 	cd ..\src
-	nmake /f Makefile.vc6 cfg=release-ssl-zlib
+	nmake /f Makefile.$(VC) cfg=release-ssl-zlib
 
 vc-ssl-dll:
 	cd lib
-	nmake /f Makefile.vc6 cfg=release-ssl-dll
+	nmake /f Makefile.$(VC) cfg=release-ssl-dll
 	cd ..\src
-	nmake /f Makefile.vc6 cfg=release-ssl-dll
+	nmake /f Makefile.$(VC) cfg=release-ssl-dll
 
 vc-dll-ssl-dll:
 	cd lib
-	nmake /f Makefile.vc6 cfg=release-dll-ssl-dll
+	nmake /f Makefile.$(VC) cfg=release-dll-ssl-dll
 	cd ..\src
-	nmake /f Makefile.vc6 cfg=release-dll-ssl-dll
+	nmake /f Makefile.$(VC) cfg=release-dll-ssl-dll
 
 vc-dll:
 	cd lib
-	nmake /f Makefile.vc6 cfg=release-dll
+	nmake /f Makefile.$(VC) cfg=release-dll
 	cd ..\src
-	nmake /f Makefile.vc6 cfg=release-dll
+	nmake /f Makefile.$(VC) cfg=release-dll
 
 vc-dll-zlib-dll:
 	cd lib
-	nmake /f Makefile.vc6 cfg=release-dll-zlib-dll
+	nmake /f Makefile.$(VC) cfg=release-dll-zlib-dll
 	cd ..\src
-	nmake /f Makefile.vc6 cfg=release-dll-zlib-dll
+	nmake /f Makefile.$(VC) cfg=release-dll-zlib-dll
 
 vc-dll-ssl-dll-zlib-dll:
 	cd lib
-	nmake /f Makefile.vc6 cfg=release-dll-ssl-dll-zlib-dll
+	nmake /f Makefile.$(VC) cfg=release-dll-ssl-dll-zlib-dll
 	cd ..\src
-	nmake /f Makefile.vc6 cfg=release-dll-ssl-dll-zlib-dll
+	nmake /f Makefile.$(VC) cfg=release-dll-ssl-dll-zlib-dll
 
 vc-ssl-dll-zlib-dll:
 	cd lib
-	nmake /f Makefile.vc6 cfg=release-ssl-dll-zlib-dll
+	nmake /f Makefile.$(VC) cfg=release-ssl-dll-zlib-dll
 	cd ..\src
-	nmake /f Makefile.vc6 cfg=release-ssl-dll-zlib-dll
+	nmake /f Makefile.$(VC) cfg=release-ssl-dll-zlib-dll
 
 vc-zlib-dll:
 	cd lib
-	nmake /f Makefile.vc6 cfg=release-zlib-dll
+	nmake /f Makefile.$(VC) cfg=release-zlib-dll
 	cd ..\src
-	nmake /f Makefile.vc6 cfg=release-zlib-dll
+	nmake /f Makefile.$(VC) cfg=release-zlib-dll
 
 vc-sspi:
 	cd lib
-	nmake /f Makefile.vc6 cfg=release WINDOWS_SSPI=1
+	nmake /f Makefile.$(VC) cfg=release WINDOWS_SSPI=1
 	cd ..\src
-	nmake /f Makefile.vc6 cfg=release WINDOWS_SSPI=1
+	nmake /f Makefile.$(VC) cfg=release WINDOWS_SSPI=1
 
 djgpp:
 	$(MAKE) -C lib -f Makefile.dj
