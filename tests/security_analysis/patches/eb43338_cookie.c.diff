@@ -1541,9 +1541,12 @@ static int cookie_output(struct CookieInfo *c, const char *dumphere)
   unsigned int j;
   struct Cookie **array;
 
+  if(!c)
+    /* no cookie engine alive */
+    return 0;
+
   /* at first, remove expired cookies */
-  if(c)
-    remove_expired(c);
+  remove_expired(c);
 
   if(!strcmp("-", dumphere)) {
     /* use stdout */
@@ -1562,7 +1565,7 @@ static int cookie_output(struct CookieInfo *c, const char *dumphere)
         "# This file was generated by libcurl! Edit at your own risk.\n\n",
         out);
 
-  if(c && c->numcookies) {
+  if(c->numcookies) {
     array = malloc(sizeof(struct Cookie *) * c->numcookies);
     if(!array) {
       if(!use_stdout)
